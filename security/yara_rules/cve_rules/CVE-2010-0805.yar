rule CVE_2010_0805 {
    meta:
        description = "Detects exploitation of Microsoft Windows Shell Link (.LNK) files"
        author = "CascadeAI"
        reference = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0805"
    strings:
        $lnk_header = {4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46}
        $malicious_target = {57 69 6E 64 6F 77 73 5C 45 78 70 6C 6F 72 65 72 2E 65 78 65}
    condition:
        all of ($lnk_header, $malicious_target)
}

rule CVE_2010_0887 {
    meta:
        description = "Detects exploitation of Microsoft Office Rich Text Format (RTF) files"
        author = "CascadeAI"
        reference = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0887"
    strings:
        $rtf_header = {7B 5C 72 74 66 31}
        $exploit_pattern = {5C 6F 62 6A 65 63 74 20 5C 64 61 74 61 20 5C 6F 62 6A 65 63 74}
    condition:
        all of ($rtf_header, $exploit_pattern)
}
